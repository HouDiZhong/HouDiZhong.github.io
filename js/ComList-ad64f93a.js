import{b as g,f as k,o as l,g as n,z as m,x,h as _,j as h,i,m as d,u as o,y as v,K as L,c as M,v as S,O as C,q as b,s as B,d as E,r as U,M as A,R as P,U as V}from"./vendor-48284a43.js";import{_ as w,b as D,p as N,d as I,F as z}from"./index-8f95a3d3.js";const y=e=>(b("data-v-205c9da2"),e=e(),B(),e),T={class:"mate-warp"},j={class:"item"},R={class:"title van-multi-ellipsis--l2"},$={class:"item-content disflx"},q={key:0,class:"pic"},K={class:"pic-date"},O={class:"date"},G=y(()=>i("i",{class:"line"},"|",-1)),H={class:"fb"},J={class:"t"},Q={class:"text"},W={key:0,class:"tag-list"},X={class:"summary van-multi-ellipsis--l2"},Y={class:"m-info"},Z={class:"a-d disflx"},tt={class:"a"},st={key:0,class:"d"},et={class:"info-b disflx"},at={class:"b-l"},it=y(()=>i("div",{class:"b-r"},"\u6536\u85CF",-1)),ot=g({props:{mlist:null},setup(e){return(t,s)=>{const r=k("router-link");return l(),n("div",T,[(l(!0),n(m,null,x(e.mlist,a=>(l(),n("div",j,[_(r,{to:a.link},{default:h(()=>[i("div",R,d(a.titleCn),1),i("div",$,[a.imgUrl?(l(),n("div",q,[i("div",K,[i("div",O,[i("i",null,d(a.dAry[1])+".",1),G,i("i",H,d(a.dAry[2]),1)]),i("div",J,d(a.categoryName),1)]),_(o(v),{src:a.imgUrl},null,8,["src"])])):L("",!0),i("div",Q,[a.tagList||a.imgUrl?(l(),n("div",W,[(l(!0),n(m,null,x(a.tagList,p=>(l(),M(o(C),{type:"primary",plain:""},{default:h(()=>[S(d(p.name),1)]),_:2},1024))),256))])):L("",!0),i("div",X,d(a.summary),1),i("div",Y,[i("div",Z,[i("div",tt,"\u4F5C\u8005\uFF1A"+d(a.authorTxt),1),a.imgUrl?L("",!0):(l(),n("div",st,d(a.date),1))]),i("div",et,[i("div",at,"\u6765\u6E90\uFF1A"+d(a.provenance),1),it])])])])]),_:2},1032,["to"])]))),256))])}}});var lt=w(ot,[["__scopeId","data-v-205c9da2"]]);const dt=e=>D("/material/list",e),nt=e=>N("/material/page",e);var rt=E("mate",{state:()=>({mateList:[],filterList:[],pullLoad:!1,finished:!1,listLoad:!1}),actions:{async getMateList(e){const{ok:t,data:s}=await dt(e);t&&(this.pullLoad=!1,this.mateList=s.materialList,this.filterList=s.themeList)},async getMatePage(e){const{ok:t,data:s}=await nt(e);t&&(this.mateList.length&&e.p!==1?this.mateList.push(...s.list):this.mateList=s.list,this.pullLoad=!1,this.listLoad=!1,this.finished=!1,s.pages===e.p&&(this.finished=!0))}},getters:{mList(){var e;return(e=this.mateList)==null||e.forEach(t=>{var s;t.link=`/material/detail/${t.id}`,t.authorTxt=t.authorName.replaceAll(","," "),t.imgUrl=((s=t.imageList)==null?void 0:s.length)?t.imageList[0].url:!1,t.date=t.publishDate?I(t.publishDate):"",t.dAry=new Date(t.date).toDateString().split(" ")}),this.mateList||[]},fltList(){return this.filterList.forEach(e=>{var t,s;e.text=e.name,e.sCount=0,e.cSize=((t=e.children)==null?void 0:t.length)||0,(s=e.children)==null||s.forEach(r=>{r.text=r.name,r.cSize=e.cSize})}),this.filterList}}});const _t=g({setup(e){const t=U({data:{k:"",o:1,s:"",p:1,ps:0},sort:1,sortList:[1,0]}),s=rt(),r=()=>{t.data.p=1,s.pullLoad=!0,t.data.s?s.getMatePage(t.data):s.getMateList(t.data)},a=()=>{t.data.p++,s.listLoad=!0,s.getMatePage(t.data)},p=(c,u)=>{t.data.s=c,t.data.p=1,c===""?(t.sort=t.sortList[0],t.data.o=t.sortList[0]):u&&(t.sort=-1),s.getMatePage(t.data)},F=c=>{t.data.o=c,t.data.p=1,t.sort=c,s.getMatePage(t.data)};return A(()=>s.getMateList(t.data)),(c,u)=>(l(),n(m,null,[_(z,{flist:o(s).fltList,sort:o(t).sort,sl:o(t).sortList,onSort:F,onFix:p},null,8,["flist","sort","sl"]),_(o(V),{modelValue:o(s).pullLoad,"onUpdate:modelValue":u[1]||(u[1]=f=>o(s).pullLoad=f),onRefresh:r},{default:h(()=>[_(o(P),{onLoad:a,finished:o(s).finished,loading:o(s).listLoad,"onUpdate:loading":u[0]||(u[0]=f=>o(s).listLoad=f),"immediate-check":!1,"finished-text":"\u6CD5\u5F8B\u4EBA\u7684\u5E95\u7EBF"},{default:h(()=>[_(lt,{mlist:o(s).mList},null,8,["mlist"])]),_:1},8,["finished","loading"])]),_:1},8,["modelValue"])],64))}});export{_t as default};
