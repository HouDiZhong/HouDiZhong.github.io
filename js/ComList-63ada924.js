import m from"./List-fb9cd780.js";import{d as h,b as p,g,v as k,Y as M,a0 as F,c as v,e as y,w as n,f as l,u as e}from"./vendor-60dab89d.js";import{m as x,c as P,d as w,e as b,F as j,a as B,L as C,i as S}from"./index-e0aacc58.js";var A=h("mate",{state:()=>({total:0,key:"",mateList:[],filterList:[],pullLoad:!1,finished:!1,listLoad:!1}),actions:{async getMateList(s){this.key=s.k;const{ok:t,data:a}=await x(s);t&&(this.pullLoad=!1,this.total=a.total,this.mateList=a.materialList,this.filterList=a.themeList,this.finished=s.p===a.pageCount)},async getMatePage(s){this.key=s.k;const{ok:t,data:a}=await P(s);t&&(this.mateList.length&&s.p!==1?this.mateList.push(...a.list):this.mateList=a.list,this.pullLoad=!1,this.listLoad=!1,this.total=a.total,this.finished=s.p===a.pages)}},getters:{mList(){return w(this.mateList,this.key)},fltList(){return b(this.filterList)}}});const U=p({props:{k:null},setup(s){const t=g({data:{k:"",o:1,s:"",p:1,ps:0},sort:1,sortList:[1,0]}),a=A(),r=()=>{t.data.p=1,a.pullLoad=!0,t.data.s?a.getMatePage(t.data):a.getMateList(t.data)},f=()=>{t.data.p++,a.listLoad=!0,a.getMatePage(t.data)},L=(i,d)=>{t.data.s=i,t.data.p=1,i===""?(t.sort=t.sortList[0],t.data.o=t.sortList[0]):d&&(t.sort=-1),a.getMatePage(t.data)},u=i=>{t.data.o=i,t.data.p=1,t.sort=i,a.getMatePage(t.data)},o=()=>{s.k&&(t.sort=0,t.data.k=s.k,t.data.o=0),t.data.p=1,a.total=0,a.getMateList(t.data)},c=k(()=>a.key!==""||a.mList.length===0);return M(o),F(()=>{c.value?o():S(o)}),(i,d)=>(v(),y(C,{k:s.k,num:e(a).total,t:"material"},{default:n(()=>[l(j,{flist:e(a).fltList,num:s.k?e(a).total:null,sort:e(t).sort,sl:e(t).sortList,onSort:u,onFix:L},null,8,["flist","num","sort","sl"]),l(B,{pload:e(a).pullLoad,lload:e(a).listLoad,fflag:e(a).finished,onDs:r,onUs:f},{default:n(()=>[l(m,{list:e(a).mList},null,8,["list"])]),_:1},8,["pload","lload","fflag"])]),_:1},8,["k","num"]))}});export{U as default};
